import{_ as U,i as L,r as u,j as V,k as B,c as t,a as s,t as r,d as R,f as d,b as c,s as T,l as b,g as k,h as j,o as a,e as q}from"./index-CERIRcW2.js";import{s as A}from"./index-uhg5r1Ll.js";import{s as N,a as v}from"./index-XVpHQhPD.js";import{s as H}from"./index-CFQQnXSI.js";import"./index-U7OHyoop.js";import"./index-CUPv0TyI.js";import"./index-yWIa-DpI.js";import"./index-DBcSeseI.js";const z={class:"dashboard"},G={class:"mb-6"},J={class:"mb-4"},K={class:"text-3xl font-bold text-surface-900 dark:text-surface-0 m-0"},O={class:"flex gap-6 flex-wrap"},Q={key:0,class:"flex items-center gap-2"},W={class:"flex items-center gap-2"},X={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},Z={class:"card-content"},ee={key:0,class:"card-value"},se={key:1,class:"skeleton-loader",style:{width:"80px",height:"40px"}},te={key:2,class:"card-percentage"},ae={class:"percentage-badge"},le={class:"percentage-text"},ie={key:3,class:"skeleton-loader",style:{width:"120px",height:"20px","margin-top":"8px"}},oe={class:"card-content"},ne={key:0,class:"card-value"},de={key:1,class:"skeleton-loader",style:{width:"80px",height:"40px"}},re={key:2,class:"card-percentage"},ce={class:"percentage-badge"},ue={class:"percentage-text"},pe={key:3,class:"skeleton-loader",style:{width:"120px",height:"20px","margin-top":"8px"}},ve={class:"card-content"},ge={key:0,class:"card-value"},fe={key:1,class:"skeleton-loader",style:{width:"80px",height:"40px"}},me={key:2,class:"card-percentage"},ye={class:"percentage-badge"},he={key:3,class:"skeleton-loader",style:{width:"120px",height:"20px","margin-top":"8px"}},_e={class:"card-content"},xe={key:0,class:"card-value"},be={key:1,class:"skeleton-loader",style:{width:"80px",height:"40px"}},ke={key:2,class:"card-percentage"},we={class:"percentage-badge"},Ce={key:3,class:"skeleton-loader",style:{width:"120px",height:"20px","margin-top":"8px"}},$e={class:"card-content"},Re={key:0,class:"card-value"},Fe={key:1,class:"skeleton-loader",style:{width:"80px",height:"40px"}},Pe={key:2,class:"card-percentage"},De={class:"percentage-badge"},Ve={key:3,class:"skeleton-loader",style:{width:"120px",height:"20px","margin-top":"8px"}},Te={class:"card-content"},Ae={key:0,class:"card-value"},Ne={key:1,class:"skeleton-loader",style:{width:"80px",height:"40px"}},Ie={key:2,class:"card-percentage"},Se={class:"percentage-badge"},Ee={key:3,class:"skeleton-loader",style:{width:"120px",height:"20px","margin-top":"8px"}},Me={class:"card-content"},Ye={key:0,class:"card-value"},Ue={key:1,class:"skeleton-loader",style:{width:"80px",height:"40px"}},Le={class:"dashboard-content"},Be={class:"content-card"},je={class:"card-header"},qe={class:"content-card"},He={class:"card-header"},ze={__name:"Dashboard",setup(Ge){const m=L(),I=j(),i=u(!1),S=V(()=>{var e,o;if(m.isAdmin){if(p.value){const x=C.value.find(f=>f.id===p.value);if(x)return`${x.name.split(" ")[0]} Dashboard`}return"Admin Dashboard"}return`${((o=(e=m.user)==null?void 0:e.name)==null?void 0:o.split(" ")[0])||"User"} Dashboard`}),y=new Date().getFullYear(),F=u([`${y}-${y+1}`,`${y-1}-${y}`,`${y-2}-${y-1}`]);u([{label:"Last 24 Hours",value:"24h"},{label:"Last 7 Days",value:"7d"},{label:"Last 30 Days",value:"30d"}]);const _=u(F.value[0]),w=u(null),C=u([]),p=u(null),l=u({received:0,total_clients:0,total_files:0,unreceived:0,pending:0,in_progress:0,ready_to_file:0,completed:0,payment_received:0,unassigned:0}),h=(n,e=!1)=>e?l.value.total_clients===0?0:Math.round(n/l.value.total_clients*100):l.value.total_files===0?0:Math.round(n/l.value.total_files*100);V(()=>[{title:"Received Files",count:l.value.received,status:"all",icon:"pi-inbox",gradient:"from-blue-500 to-blue-600",showPercentage:!0,percentageText:"of total clients",isReceivedCard:!0},{title:"Unreceived Files",count:l.value.unreceived,status:"secondary",icon:"pi-exclamation-triangle",gradient:"from-gray-500 to-gray-600",showPercentage:!0,percentageText:"of total clients",isReceivedCard:!0},{title:"Pending Files",count:l.value.pending,status:"warning",icon:"pi-clock",gradient:"from-orange-500 to-red-500",showPercentage:!0,percentageText:"of total files",isReceivedCard:!1},{title:"In Progress",count:l.value.in_progress,status:"in-progress",icon:"pi-cog",gradient:"from-indigo-500 to-purple-500",showPercentage:!0,percentageText:"of total files",isReceivedCard:!1},{title:"Ready to File",count:l.value.ready_to_file,status:"ready-to-file",icon:"pi-file",gradient:"from-cyan-500 to-blue-500",showPercentage:!0,percentageText:"of total files",isReceivedCard:!1},{title:"Completed Files",count:l.value.completed,status:"completed",icon:"pi-check-circle",gradient:"from-emerald-500 to-green-500",showPercentage:!0,percentageText:"of total files",isReceivedCard:!1},{title:"Payment Received",count:l.value.payment_received,status:"payment_received",icon:"pi-wallet",gradient:"from-teal-500 to-emerald-500",showPercentage:!1,isReceivedCard:!1}]);const P=u([]),D=u([]),$=async()=>{i.value=!0;try{const n=await k.get("/dashboard/stats",{params:{assessment_year:_.value,employee_id:p.value,time_period:w.value}});l.value=n.data;const o=(await k.get("/files")).data;P.value=o.slice(0,5),l.value.payment_received=o.filter(f=>f.status==="payment_received"&&f.payment_id!==null).length;const x=await k.get("/invoices");D.value=(x.data||[]).filter(f=>f.status==="unpaid").slice(0,5)}catch(n){console.error("Error fetching dashboard data:",n)}finally{i.value=!1}},E=async()=>{if(m.isAdmin)try{const n=await k.get("/employees",{params:{role:"employee"}});C.value=n.data}catch(n){console.error("Error fetching employees:",n)}},g=n=>{const e={status:n,year:_.value};w.value&&(e.time_period=w.value),p.value&&(e.employee_id=p.value),I.push({path:"/files",query:e})},M=n=>new Intl.NumberFormat("en-IN").format(n),Y=n=>({received:"secondary",assigned:"info","in-progress":"info","ready-to-file":"info",filed:"success",completed:"success"})[n]||"secondary";return B(()=>{E(),$()}),(n,e)=>(a(),t("div",z,[s("div",G,[s("div",J,[s("h2",K,r(S.value),1)]),s("div",O,[d(m).isAdmin?(a(),t("div",Q,[e[11]||(e[11]=s("i",{class:"pi pi-users text-surface-600 dark:text-surface-400"},null,-1)),c(d(A),{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=o=>p.value=o),options:C.value,optionLabel:"name",optionValue:"id",placeholder:"Select Employee",class:"w-64",showClear:"",onChange:$},null,8,["modelValue","options"])])):R("",!0),s("div",W,[e[12]||(e[12]=s("i",{class:"pi pi-calendar text-surface-600 dark:text-surface-400"},null,-1)),c(d(A),{modelValue:_.value,"onUpdate:modelValue":e[1]||(e[1]=o=>_.value=o),options:F.value,placeholder:"Select Year",class:"w-64",onChange:$},null,8,["modelValue","options"])])])]),s("div",X,[s("div",{class:"dashboard-card card-blue",onClick:e[2]||(e[2]=o=>!i.value&&g("all"))},[e[15]||(e[15]=s("div",{class:"card-bg-pattern"},null,-1)),s("div",Z,[s("div",null,[e[13]||(e[13]=s("p",{class:"card-label"},"Received Files",-1)),i.value?(a(),t("div",se)):(a(),t("h3",ee,r(l.value.received),1)),i.value?(a(),t("div",ie)):(a(),t("div",te,[s("span",ae,r(h(l.value.received,!0))+"%",1),s("span",le,"from "+r(l.value.total_clients)+" clients",1)]))]),e[14]||(e[14]=s("div",{class:"card-icon-wrapper"},[s("i",{class:"pi pi-inbox card-icon"})],-1))])]),p.value?R("",!0):(a(),t("div",{key:0,class:"dashboard-card card-gray",onClick:e[3]||(e[3]=o=>!i.value&&g("unreceived"))},[e[18]||(e[18]=s("div",{class:"card-bg-pattern"},null,-1)),s("div",oe,[s("div",null,[e[16]||(e[16]=s("p",{class:"card-label"},"Unreceived Files",-1)),i.value?(a(),t("div",de)):(a(),t("h3",ne,r(l.value.unreceived),1)),i.value?(a(),t("div",pe)):(a(),t("div",re,[s("span",ce,r(h(l.value.unreceived,!0))+"%",1),s("span",ue,"from "+r(l.value.total_clients)+" clients",1)]))]),e[17]||(e[17]=s("div",{class:"card-icon-wrapper"},[s("i",{class:"pi pi-exclamation-triangle card-icon"})],-1))])])),s("div",{class:"dashboard-card card-orange",onClick:e[4]||(e[4]=o=>!i.value&&g("pending"))},[e[22]||(e[22]=s("div",{class:"card-bg-pattern"},null,-1)),s("div",ve,[s("div",null,[e[20]||(e[20]=s("p",{class:"card-label"},"Pending Files",-1)),i.value?(a(),t("div",fe)):(a(),t("h3",ge,r(l.value.pending),1)),i.value?(a(),t("div",he)):(a(),t("div",me,[s("span",ye,r(h(l.value.pending,!1))+"%",1),e[19]||(e[19]=s("span",{class:"percentage-text"},"of total files",-1))]))]),e[21]||(e[21]=s("div",{class:"card-icon-wrapper"},[s("i",{class:"pi pi-clock card-icon"})],-1))])]),s("div",{class:"dashboard-card card-purple",onClick:e[5]||(e[5]=o=>!i.value&&g("in-progress"))},[e[26]||(e[26]=s("div",{class:"card-bg-pattern"},null,-1)),s("div",_e,[s("div",null,[e[24]||(e[24]=s("p",{class:"card-label"},"In Progress",-1)),i.value?(a(),t("div",be)):(a(),t("h3",xe,r(l.value.in_progress),1)),i.value?(a(),t("div",Ce)):(a(),t("div",ke,[s("span",we,r(h(l.value.in_progress,!1))+"%",1),e[23]||(e[23]=s("span",{class:"percentage-text"},"of total files",-1))]))]),e[25]||(e[25]=s("div",{class:"card-icon-wrapper"},[s("i",{class:"pi pi-cog card-icon"})],-1))])]),s("div",{class:"dashboard-card card-cyan",onClick:e[6]||(e[6]=o=>!i.value&&g("ready-to-file"))},[e[30]||(e[30]=s("div",{class:"card-bg-pattern"},null,-1)),s("div",$e,[s("div",null,[e[28]||(e[28]=s("p",{class:"card-label"},"Ready to File",-1)),i.value?(a(),t("div",Fe)):(a(),t("h3",Re,r(l.value.ready_to_file),1)),i.value?(a(),t("div",Ve)):(a(),t("div",Pe,[s("span",De,r(h(l.value.ready_to_file,!1))+"%",1),e[27]||(e[27]=s("span",{class:"percentage-text"},"of total files",-1))]))]),e[29]||(e[29]=s("div",{class:"card-icon-wrapper"},[s("i",{class:"pi pi-file card-icon"})],-1))])]),s("div",{class:"dashboard-card card-green",onClick:e[7]||(e[7]=o=>!i.value&&g("completed"))},[e[34]||(e[34]=s("div",{class:"card-bg-pattern"},null,-1)),s("div",Te,[s("div",null,[e[32]||(e[32]=s("p",{class:"card-label"},"Completed Files",-1)),i.value?(a(),t("div",Ne)):(a(),t("h3",Ae,r(l.value.completed),1)),i.value?(a(),t("div",Ee)):(a(),t("div",Ie,[s("span",Se,r(h(l.value.completed,!1))+"%",1),e[31]||(e[31]=s("span",{class:"percentage-text"},"of total files",-1))]))]),e[33]||(e[33]=s("div",{class:"card-icon-wrapper"},[s("i",{class:"pi pi-check-circle card-icon"})],-1))])]),d(m).isAdmin||d(m).isManager?(a(),t("div",{key:1,class:"dashboard-card card-teal",onClick:e[8]||(e[8]=o=>!i.value&&g("payment_received"))},[e[37]||(e[37]=s("div",{class:"card-bg-pattern"},null,-1)),s("div",Me,[s("div",null,[e[35]||(e[35]=s("p",{class:"card-label"},"Payment Received",-1)),i.value?(a(),t("div",Ue)):(a(),t("h3",Ye,r(l.value.payment_received),1))]),e[36]||(e[36]=s("div",{class:"card-icon-wrapper"},[s("i",{class:"pi pi-wallet card-icon"})],-1))])])):R("",!0)]),s("div",Le,[s("div",Be,[s("div",je,[e[38]||(e[38]=s("h2",null,"Recent Files",-1)),c(d(T),{label:"View All",text:"",onClick:e[9]||(e[9]=o=>n.$router.push("/files"))})]),c(d(N),{value:P.value,loading:i.value},{default:b(()=>[c(d(v),{field:"file_type",header:"File Type"}),c(d(v),{field:"client.business_name",header:"Client"}),c(d(v),{field:"assessment_year",header:"Assessment Year"}),c(d(v),{field:"status",header:"Status"},{body:b(o=>[c(d(H),{value:o.data.status,severity:Y(o.data.status)},null,8,["value","severity"])]),_:1})]),_:1},8,["value","loading"])]),s("div",qe,[s("div",He,[e[39]||(e[39]=s("h2",null,"Pending Invoices",-1)),c(d(T),{label:"View All",text:"",onClick:e[10]||(e[10]=o=>n.$router.push("/billing"))})]),c(d(N),{value:D.value,loading:i.value},{default:b(()=>[c(d(v),{field:"invoice_number",header:"Invoice #"}),c(d(v),{field:"client.business_name",header:"Client"}),c(d(v),{field:"total_amount",header:"Amount"},{body:b(o=>[q(" â‚¹"+r(M(o.data.total_amount)),1)]),_:1}),c(d(v),{field:"due_date",header:"Due Date"})]),_:1},8,["value","loading"])])])]))}},ss=U(ze,[["__scopeId","data-v-620aa236"]]);export{ss as default};
