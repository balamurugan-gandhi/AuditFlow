import{u as E,r as f,j as F,k as P,g as x,c as n,b as r,a as e,d as N,f as a,h as B,s as A,q as _,x as k,t as l,l as m,C as R,p as D,o as c,e as M}from"./index-CERIRcW2.js";import{s as $}from"./index-CFQQnXSI.js";import{s as W,a as p}from"./index-XVpHQhPD.js";import{s as o}from"./index-CQSetL0I.js";import{s as I}from"./index-uhg5r1Ll.js";import{s as U}from"./index-C7FIN1Lj.js";import{s as q}from"./index-BdTjmT_3.js";import"./index-U7OHyoop.js";import"./index-CUPv0TyI.js";import"./index-yWIa-DpI.js";import"./index-DBcSeseI.js";const z={class:"space-y-6"},G={class:"flex justify-end items-center"},H={key:0,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},L={class:"lg:col-span-2 space-y-6"},O={class:"card bg-white dark:bg-surface-800 rounded-xl shadow-sm p-6 border border-surface-200 dark:border-surface-700"},J={class:"flex justify-between items-start mb-6"},K={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Q={class:"info-item md:col-span-2"},X={class:"card bg-white dark:bg-surface-800 rounded-xl shadow-sm p-6 border border-surface-200 dark:border-surface-700"},Z={class:"space-y-4"},ee={class:"space-y-6"},se={class:"card bg-white dark:bg-surface-800 rounded-xl shadow-sm p-6 border border-surface-200 dark:border-surface-700"},te={class:"space-y-4"},ae={class:"flex-1"},re={key:1,class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},ie={class:"lg:col-span-2 space-y-6"},oe={class:"card bg-white dark:bg-surface-800 rounded-xl shadow-sm p-6 border border-surface-200 dark:border-surface-700"},de={class:"flex justify-between items-start mb-6"},le={class:"text-xl font-bold text-surface-900 dark:text-surface-0 m-0"},ne={class:"text-surface-500 dark:text-surface-400 mt-1"},ce={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ue={class:"info-item"},fe={class:"text-surface-900 dark:text-surface-0 font-medium"},me={class:"info-item"},pe={class:"text-surface-900 dark:text-surface-0 font-medium"},be={class:"info-item"},ve={class:"text-surface-900 dark:text-surface-0 font-medium"},ge={class:"info-item"},he={class:"text-surface-900 dark:text-surface-0 font-medium"},xe={class:"info-item md:col-span-2"},_e={class:"text-surface-900 dark:text-surface-0 font-medium"},ke={class:"card bg-white dark:bg-surface-800 rounded-xl shadow-sm p-6 border border-surface-200 dark:border-surface-700"},ye={class:"flex justify-between items-center mb-4"},we={class:"space-y-6"},Ne={class:"card bg-white dark:bg-surface-800 rounded-xl shadow-sm p-6 border border-surface-200 dark:border-surface-700"},Ae={class:"space-y-4"},$e={class:"flex items-center gap-3 p-3 bg-surface-50 dark:bg-surface-900 rounded-lg"},Ce=["href"],Ve={class:"flex items-center gap-3 p-3 bg-surface-50 dark:bg-surface-900 rounded-lg"},je=["href"],Se={key:1,class:"text-surface-900 dark:text-surface-0 font-medium"},Ye={class:"flex items-center gap-3 p-3 bg-surface-50 dark:bg-surface-900 rounded-lg"},Te=["href"],Ee={class:"card bg-white dark:bg-surface-800 rounded-xl shadow-sm p-6 border border-surface-200 dark:border-surface-700"},Fe={class:"space-y-4"},Pe={key:0,class:"flex items-center justify-between p-3 bg-surface-50 dark:bg-surface-900 rounded-lg"},Oe={__name:"ClientDetails",setup(Be){const C=D(),y=B(),b=E(),t=f(null),w=f(!0),u=new Date().getFullYear(),V=f(["All Years",`${u}-${u+1}`,`${u-1}-${u}`,`${u-2}-${u-1}`]),v=f("All Years"),j=F(()=>!t.value||!t.value.files?[]:v.value==="All Years"?t.value.files:t.value.files.filter(d=>d.assessment_year===v.value)),S=async()=>{try{const d=await x.get(`/clients/${C.params.id}`);t.value=d.data,t.value&&(t.value.whatsapp_notification_enabled=!!t.value.whatsapp_notification_enabled)}catch(d){console.error("Error fetching client:",d),b.add({severity:"error",summary:"Error",detail:"Failed to load client details",life:3e3})}finally{w.value=!1}},Y=async()=>{if(t.value.whatsapp_notification_enabled&&!t.value.whatsapp_number&&!t.value.phone){setTimeout(()=>{t.value.whatsapp_notification_enabled=!1},200),b.add({severity:"warn",summary:"Missing Contact Info",detail:"Please add WhatsApp number to enable this notification setting",life:3e3});return}try{await x.put(`/clients/${t.value.id}`,{whatsapp_notification_enabled:t.value.whatsapp_notification_enabled}),b.add({severity:"success",summary:"Success",detail:"Notification settings updated",life:3e3})}catch(d){console.error("Error updating settings:",d),t.value.whatsapp_notification_enabled=!t.value.whatsapp_notification_enabled,b.add({severity:"error",summary:"Error",detail:"Failed to update settings",life:3e3})}},T=d=>({received:"secondary",assigned:"info","in-progress":"info","ready-to-file":"info",filed:"success",completed:"success"})[d]||"secondary",g=f(!1);return P(async()=>{S();try{const s=(await x.get("/plugins")).data.find(i=>i.name==="whatsapp-meta");g.value=!!(s&&s.enabled)}catch{g.value=!1}}),(d,s)=>(c(),n("div",z,[r(a(q)),e("div",G,[r(a(A),{label:"Back",icon:"pi pi-arrow-left",text:"",onClick:s[0]||(s[0]=i=>a(y).back())})]),w.value?(c(),n("div",H,[e("div",L,[e("div",O,[e("div",J,[e("div",null,[r(a(o),{width:"16rem",height:"2rem",class:"mb-2"}),r(a(o),{width:"8rem",height:"1rem"})]),r(a(o),{width:"6rem",height:"2rem",borderRadius:"16px"})]),e("div",K,[(c(),n(_,null,k(4,i=>e("div",{class:"info-item",key:i},[r(a(o),{width:"6rem",height:"1rem",class:"mb-2"}),r(a(o),{width:"100%",height:"1.5rem"})])),64)),e("div",Q,[r(a(o),{width:"6rem",height:"1rem",class:"mb-2"}),r(a(o),{width:"100%",height:"1.5rem"})])])]),e("div",X,[r(a(o),{width:"10rem",height:"1.5rem",class:"mb-4"}),e("div",Z,[(c(),n(_,null,k(3,i=>r(a(o),{width:"100%",height:"3rem",key:i})),64))])])]),e("div",ee,[e("div",se,[r(a(o),{width:"10rem",height:"1.5rem",class:"mb-4"}),e("div",te,[(c(),n(_,null,k(3,i=>e("div",{class:"flex items-center gap-3 p-3 bg-surface-50 dark:bg-surface-900 rounded-lg",key:i},[r(a(o),{shape:"circle",size:"2.5rem"}),e("div",ae,[r(a(o),{width:"5rem",height:"0.8rem",class:"mb-1"}),r(a(o),{width:"80%",height:"1rem"})])])),64))])])])])):t.value?(c(),n("div",re,[e("div",ie,[e("div",oe,[e("div",de,[e("div",null,[e("h3",le,l(t.value.business_name),1),e("p",ne,l(t.value.business_type||"Business Type N/A"),1)]),r(a($),{value:t.value.filing_cycle||"Cycle N/A",severity:"info"},null,8,["value"])]),e("div",ce,[e("div",ue,[s[3]||(s[3]=e("label",{class:"block text-sm font-medium text-surface-500 dark:text-surface-400 mb-1"},"Contact Person",-1)),e("div",fe,l(t.value.contact_person||"N/A"),1)]),e("div",me,[s[4]||(s[4]=e("label",{class:"block text-sm font-medium text-surface-500 dark:text-surface-400 mb-1"},"PAN Number",-1)),e("div",pe,l(t.value.pan_number||"N/A"),1)]),e("div",be,[s[5]||(s[5]=e("label",{class:"block text-sm font-medium text-surface-500 dark:text-surface-400 mb-1"},"GST Number",-1)),e("div",ve,l(t.value.gst_number||"N/A"),1)]),e("div",ge,[s[6]||(s[6]=e("label",{class:"block text-sm font-medium text-surface-500 dark:text-surface-400 mb-1"},"TIN Number",-1)),e("div",he,l(t.value.tin_number||"N/A"),1)]),e("div",xe,[s[7]||(s[7]=e("label",{class:"block text-sm font-medium text-surface-500 dark:text-surface-400 mb-1"},"Address",-1)),e("div",_e,l(t.value.address||"N/A"),1)])])]),e("div",ke,[e("div",ye,[s[8]||(s[8]=e("h3",{class:"text-lg font-bold text-surface-900 dark:text-surface-0 m-0"},"File History",-1)),r(a(I),{modelValue:v.value,"onUpdate:modelValue":s[1]||(s[1]=i=>v.value=i),options:V.value,placeholder:"Select Year",class:"w-48"},null,8,["modelValue","options"])]),r(a(W),{value:j.value,stripedRows:"",class:"p-datatable-sm",paginator:"",rows:5,rowsPerPageOptions:[5,10,20]},{empty:m(()=>[...s[9]||(s[9]=[e("div",{class:"text-center p-4"},"No files found for this client.",-1)])]),default:m(()=>[r(a(p),{field:"file_type",header:"File Type"}),r(a(p),{field:"assessment_year",header:"Year"}),r(a(p),{field:"status",header:"Status"},{body:m(i=>[r(a($),{value:i.data.status,severity:T(i.data.status)},null,8,["value","severity"])]),_:1}),r(a(p),{field:"assignee.name",header:"Assigned To"},{body:m(i=>{var h;return[M(l(((h=i.data.assignee)==null?void 0:h.name)||"Unassigned"),1)]}),_:1}),r(a(p),{header:"Actions",style:{width:"4rem"}},{body:m(i=>[r(a(A),{icon:"pi pi-eye",text:"",rounded:"",severity:"secondary",onClick:h=>a(y).push(`/files/${i.data.id}`)},null,8,["onClick"])]),_:1})]),_:1},8,["value"])])]),e("div",we,[e("div",Ne,[s[16]||(s[16]=e("h3",{class:"text-lg font-bold text-surface-900 dark:text-surface-0 mb-4"},"Contact Information",-1)),e("div",Ae,[e("div",$e,[s[11]||(s[11]=e("div",{class:"w-10 h-10 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400"},[e("i",{class:"pi pi-phone text-lg"})],-1)),e("div",null,[s[10]||(s[10]=e("label",{class:"block text-xs font-medium text-surface-500 dark:text-surface-400"},"Phone Number",-1)),e("a",{href:`tel:${t.value.phone}`,class:"text-surface-900 dark:text-surface-0 font-medium hover:text-primary-500 transition-colors"},l(t.value.phone||"N/A"),9,Ce)])]),e("div",Ve,[s[13]||(s[13]=e("div",{class:"w-10 h-10 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center text-green-600 dark:text-green-400"},[e("i",{class:"pi pi-whatsapp text-lg"})],-1)),e("div",null,[s[12]||(s[12]=e("label",{class:"block text-xs font-medium text-surface-500 dark:text-surface-400"},"WhatsApp",-1)),t.value.whatsapp_number||t.value.phone?(c(),n("a",{key:0,href:`https://wa.me/${(t.value.whatsapp_number||t.value.phone).replace(/\D/g,"")}`,target:"_blank",class:"text-surface-900 dark:text-surface-0 font-medium hover:text-primary-500 transition-colors"},l(t.value.whatsapp_number||t.value.phone||"N/A"),9,je)):(c(),n("span",Se,"N/A"))])]),e("div",Ye,[s[15]||(s[15]=e("div",{class:"w-10 h-10 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center text-orange-600 dark:text-orange-400"},[e("i",{class:"pi pi-envelope text-lg"})],-1)),e("div",null,[s[14]||(s[14]=e("label",{class:"block text-xs font-medium text-surface-500 dark:text-surface-400"},"Email Address",-1)),e("a",{href:`mailto:${t.value.email}`,class:"text-surface-900 dark:text-surface-0 font-medium hover:text-primary-500 transition-colors"},l(t.value.email||"N/A"),9,Te)])])])]),e("div",Ee,[s[18]||(s[18]=e("h3",{class:"text-lg font-bold text-surface-900 dark:text-surface-0 mb-4"},"Notification Settings",-1)),e("div",Fe,[g.value?(c(),n("div",Pe,[s[17]||(s[17]=R('<div class="flex items-center gap-3"><div class="w-10 h-10 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center text-green-600 dark:text-green-400"><i class="pi pi-whatsapp text-lg"></i></div><div><label class="block text-sm font-medium text-surface-900 dark:text-surface-0">WhatsApp Notifications</label><span class="block text-xs text-surface-500 dark:text-surface-400">Receive updates via WhatsApp</span></div></div>',1)),r(a(U),{modelValue:t.value.whatsapp_notification_enabled,"onUpdate:modelValue":s[2]||(s[2]=i=>t.value.whatsapp_notification_enabled=i),onChange:Y},null,8,["modelValue"])])):N("",!0)])])])])):N("",!0)]))}};export{Oe as default};
