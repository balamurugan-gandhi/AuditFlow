import{j as V,p as C,r as p,k as M,c as d,a as t,q as N,x as R,y as q,d as i,b as u,f as r,n as x,t as m,J as B,h as A,s as _,g,o as n}from"./index-CERIRcW2.js";import{s as j}from"./index-uhg5r1Ll.js";import{s as U}from"./index-CQSetL0I.js";import{s as E}from"./index-DKo52fcK.js";import{s as G}from"./index-BSCWIYhD.js";import"./index-U7OHyoop.js";import"./index-CUPv0TyI.js";import"./index-ClklKdBC.js";import"./index-DBcSeseI.js";const I={class:"max-w-2xl mx-auto space-y-6"},J={class:"card bg-white dark:bg-surface-800 rounded-xl shadow-sm p-6"},L={key:0,class:"space-y-6"},P={class:"grid grid-cols-1 gap-6"},z={class:"grid grid-cols-1 gap-6"},O={class:"flex flex-col gap-2"},W={key:0,class:"text-red-500"},Y={class:"flex flex-col gap-2"},H={key:0,class:"text-red-500"},K={key:0,class:"flex flex-col gap-2"},Q={key:0,class:"text-red-500"},T={class:"flex flex-col gap-2"},X={key:0,class:"text-red-500"},Z={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ee={class:"flex flex-col gap-2"},ae={key:0,class:"text-red-500"},le={class:"flex flex-col gap-2"},se={key:0,class:"text-red-500"},te={class:"flex flex-col gap-2"},oe={key:0,class:"text-red-500"},de={class:"flex flex-col gap-2"},re={key:0,class:"text-red-500"},ne={class:"flex flex-col gap-2"},ue={key:0,class:"text-red-500"},ie={class:"flex flex-col gap-2"},me={key:0,class:"text-red-500"},pe={class:"flex justify-end gap-3"},_e={__name:"EmployeeForm",setup(ve){const y=A(),v=C(),c=V(()=>!!v.params.id),b=p(!1),k=p(!!v.params.id),D=p([{name:"admin"},{name:"manager"},{name:"employee"}]),h=p([]);p(null);const a=p({name:"",email:"",password:"",role:"employee",clients:[],phone:"",whatsapp_number:"",address:"",doj:null,dob:null,gender:""}),s=p({});V(()=>h.value.filter(o=>a.value.clients.includes(o.id))),V(()=>h.value.filter(o=>!a.value.clients.includes(o.id)));const $=async()=>{try{const o=await g.get("/clients");h.value=o.data}catch(o){console.error("Error fetching clients:",o)}},F=async()=>{var o,e;if(c.value)try{const l=await g.get(`/employees/${v.params.id}`);a.value={name:l.data.name,email:l.data.email,role:((o=l.data.roles[0])==null?void 0:o.name)||"employee",clients:((e=l.data.clients)==null?void 0:e.map(w=>w.id))||[],phone:l.data.phone,whatsapp_number:l.data.whatsapp_number,address:l.data.address,doj:l.data.doj?new Date(l.data.doj):null,dob:l.data.dob?new Date(l.data.dob):null,gender:l.data.gender}}catch(l){console.error("Error fetching employee:",l),y.push("/employees")}finally{k.value=!1}},f=o=>{if(!o)return null;const e=new Date(o),l=""+(e.getMonth()+1),w=""+e.getDate();return[e.getFullYear(),l.padStart(2,"0"),w.padStart(2,"0")].join("-")},S=async()=>{var o;b.value=!0,s.value={};try{c.value?await g.put(`/employees/${v.params.id}`,{name:a.value.name,email:a.value.email,role:a.value.role,clients:a.value.clients,phone:a.value.phone,whatsapp_number:a.value.whatsapp_number,address:a.value.address,doj:a.value.doj?f(a.value.doj):null,dob:a.value.dob?f(a.value.dob):null,gender:a.value.gender}):await g.post("/employees",{...a.value,doj:a.value.doj?f(a.value.doj):null,dob:a.value.dob?f(a.value.dob):null}),y.push("/employees")}catch(e){console.error("Error saving employee:",e),((o=e.response)==null?void 0:o.status)===422&&(s.value=e.response.data.errors||{})}finally{b.value=!1}};return M(async()=>{await $(),await F()}),(o,e)=>(n(),d("div",I,[t("div",J,[k.value?(n(),d("div",L,[t("div",P,[(n(),d(N,null,R(5,l=>t("div",{key:l,class:"flex flex-col gap-2"},[u(r(U),{width:"6rem",height:"1rem"}),u(r(U),{width:"100%",height:"2.5rem"})])),64))])])):(n(),d("form",{key:1,onSubmit:q(S,["prevent"]),class:"space-y-6"},[t("div",z,[t("div",O,[e[12]||(e[12]=t("label",{for:"name",class:"text-sm font-medium text-surface-700 dark:text-surface-200"},"Name",-1)),u(r(x),{id:"name",modelValue:a.value.name,"onUpdate:modelValue":e[0]||(e[0]=l=>a.value.name=l),invalid:!!s.value.name,required:""},null,8,["modelValue","invalid"]),s.value.name?(n(),d("small",W,m(s.value.name[0]),1)):i("",!0)]),t("div",Y,[e[13]||(e[13]=t("label",{for:"email",class:"text-sm font-medium text-surface-700 dark:text-surface-200"},"Email",-1)),u(r(x),{id:"email",modelValue:a.value.email,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.email=l),type:"email",invalid:!!s.value.email,required:""},null,8,["modelValue","invalid"]),s.value.email?(n(),d("small",H,m(s.value.email[0]),1)):i("",!0)]),c.value?i("",!0):(n(),d("div",K,[e[14]||(e[14]=t("label",{for:"password",class:"text-sm font-medium text-surface-700 dark:text-surface-200"},"Password",-1)),u(r(B),{id:"password",modelValue:a.value.password,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.password=l),feedback:!1,toggleMask:"",invalid:!!s.value.password,required:""},null,8,["modelValue","invalid"]),s.value.password?(n(),d("small",Q,m(s.value.password[0]),1)):i("",!0)])),t("div",T,[e[15]||(e[15]=t("label",{for:"role",class:"text-sm font-medium text-surface-700 dark:text-surface-200"},"Role",-1)),u(r(j),{id:"role",modelValue:a.value.role,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.role=l),options:D.value,optionLabel:"name",optionValue:"name",placeholder:"Select a Role",class:"w-full",invalid:!!s.value.role},null,8,["modelValue","options","invalid"]),s.value.role?(n(),d("small",X,m(s.value.role[0]),1)):i("",!0)]),t("div",Z,[t("div",ee,[e[16]||(e[16]=t("label",{for:"phone",class:"text-sm font-medium text-surface-700 dark:text-surface-200"},"Phone",-1)),u(r(x),{id:"phone",modelValue:a.value.phone,"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.phone=l),invalid:!!s.value.phone},null,8,["modelValue","invalid"]),s.value.phone?(n(),d("small",ae,m(s.value.phone[0]),1)):i("",!0)]),t("div",le,[e[17]||(e[17]=t("label",{for:"whatsapp_number",class:"text-sm font-medium text-surface-700 dark:text-surface-200"},"WhatsApp Number",-1)),u(r(x),{id:"whatsapp_number",modelValue:a.value.whatsapp_number,"onUpdate:modelValue":e[5]||(e[5]=l=>a.value.whatsapp_number=l),invalid:!!s.value.whatsapp_number},null,8,["modelValue","invalid"]),s.value.whatsapp_number?(n(),d("small",se,m(s.value.whatsapp_number[0]),1)):i("",!0)]),t("div",te,[e[18]||(e[18]=t("label",{for:"dob",class:"text-sm font-medium text-surface-700 dark:text-surface-200"},"Date of Birth",-1)),u(r(E),{id:"dob",modelValue:a.value.dob,"onUpdate:modelValue":e[6]||(e[6]=l=>a.value.dob=l),dateFormat:"yy-mm-dd",showIcon:"",invalid:!!s.value.dob},null,8,["modelValue","invalid"]),s.value.dob?(n(),d("small",oe,m(s.value.dob[0]),1)):i("",!0)]),t("div",de,[e[19]||(e[19]=t("label",{for:"gender",class:"text-sm font-medium text-surface-700 dark:text-surface-200"},"Gender",-1)),u(r(j),{id:"gender",modelValue:a.value.gender,"onUpdate:modelValue":e[7]||(e[7]=l=>a.value.gender=l),options:["Male","Female","Other"],placeholder:"Select Gender",class:"w-full",invalid:!!s.value.gender},null,8,["modelValue","invalid"]),s.value.gender?(n(),d("small",re,m(s.value.gender[0]),1)):i("",!0)]),t("div",ne,[e[20]||(e[20]=t("label",{for:"doj",class:"text-sm font-medium text-surface-700 dark:text-surface-200"},"Date of Joining",-1)),u(r(E),{id:"doj",modelValue:a.value.doj,"onUpdate:modelValue":e[8]||(e[8]=l=>a.value.doj=l),dateFormat:"yy-mm-dd",showIcon:"",invalid:!!s.value.doj},null,8,["modelValue","invalid"]),s.value.doj?(n(),d("small",ue,m(s.value.doj[0]),1)):i("",!0)])]),t("div",ie,[e[21]||(e[21]=t("label",{for:"address",class:"text-sm font-medium text-surface-700 dark:text-surface-200"},"Address",-1)),u(r(G),{id:"address",modelValue:a.value.address,"onUpdate:modelValue":e[9]||(e[9]=l=>a.value.address=l),rows:"3",autoResize:"",invalid:!!s.value.address},null,8,["modelValue","invalid"]),s.value.address?(n(),d("small",me,m(s.value.address[0]),1)):i("",!0)]),i("",!0)]),t("div",pe,[u(r(_),{label:"Cancel",severity:"secondary",onClick:e[11]||(e[11]=l=>r(y).back())}),u(r(_),{type:"submit",label:c.value?"Update Employee":"Create Employee",loading:b.value},null,8,["label","loading"])])],32))])]))}};export{_e as default};
